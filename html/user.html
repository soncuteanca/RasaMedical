<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>User Profile - Medical Assistant</title>
    <style>
        body {
            background-color: #E8F5E9;
            font-family: Arial, sans-serif;
            margin: 0;
            color: #2b2b2b;
        }
        .container {
            max-width: 900px;
            margin: 40px auto;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 32px 40px 40px 40px;
        }
        h2 {
            color: #4CAF50;
            margin-top: 0;
        }
        .profile-section {
            border-bottom: 1px solid #C8E6C9;
            padding-bottom: 18px;
            margin-bottom: 24px;
        }
        .profile-info {
            display: flex;
            align-items: center;
            gap: 32px;
        }
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #C8E6C9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: #4CAF50;
            font-weight: bold;
        }
        .profile-details {
            flex: 1;
        }
        .section {
            margin-bottom: 32px;
        }
        .section-title {
            font-size: 20px;
            color: #2b8a28;
            margin-bottom: 10px;
        }
        .record-list, .appointment-list {
            list-style: none;
            padding: 0;
        }
        .record-list li, .appointment-list li {
            background: #F1F8E9;
            margin-bottom: 10px;
            padding: 14px 18px;
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
        }
        .empty-msg {
            color: #888;
            font-style: italic;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 18px;
            color: #4CAF50;
            text-decoration: none;
            font-weight: bold;
        }
        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
<div class="container">
    <a href="home_page.html" class="back-link">&larr; Back to Home</a>
    <div class="profile-section">
        <div class="profile-info">
            <div class="profile-avatar" id="profileAvatar">U</div>
            <div class="profile-details">
                <h2 id="profileName">User Name</h2>
                <div id="profileEmail">user@email.com</div>
            </div>
        </div>
    </div>
    <div class="section">
        <div class="section-title">Appointments</div>
        <ul class="appointment-list" id="appointmentList">
            <li class="empty-msg">Loading appointments...</li>
        </ul>
    </div>
    <div class="section">
        <div class="section-title">Medical Records</div>
        <ul class="record-list" id="recordList">
            <li class="empty-msg">Loading medical records...</li>
        </ul>
    </div>
</div>
<script>
// Load user info from localStorage
const user = localStorage.getItem('user');
if (!user) {
    window.location.href = 'login.html';
}
const userObj = JSON.parse(user);
document.getElementById('profileName').textContent = userObj.name || 'User';
document.getElementById('profileEmail').textContent = userObj.email || '';
document.getElementById('profileAvatar').textContent = userObj.name ? userObj.name.charAt(0).toUpperCase() : 'U';

// Fetch appointments
fetch(`http://localhost:5000/api/appointments?user_id=${userObj.id}`)
    .then(res => res.json())
    .then(data => {
        const list = document.getElementById('appointmentList');
        list.innerHTML = '';
        if (Array.isArray(data) && data.length > 0) {
            data.forEach(app => {
                const li = document.createElement('li');
                li.textContent = `Date: ${app.appointment_date} | Reason: ${app.reason || 'N/A'} | Status: ${app.status || 'scheduled'}`;
                list.appendChild(li);
            });
        } else {
            list.innerHTML = '<li class="empty-msg">No appointments found.</li>';
        }
    })
    .catch(() => {
        document.getElementById('appointmentList').innerHTML = '<li class="empty-msg">Failed to load appointments.</li>';
    });

// Fetch medical records
fetch(`http://localhost:5000/api/records?user_id=${userObj.id}`)
    .then(res => res.json())
    .then(data => {
        const list = document.getElementById('recordList');
        list.innerHTML = '';
        if (Array.isArray(data) && data.length > 0) {
            data.forEach(rec => {
                const li = document.createElement('li');
                li.textContent = `Diagnosis: ${rec.diagnosis} | Treatment: ${rec.treatment}`;
                list.appendChild(li);
            });
        } else {
            list.innerHTML = '<li class="empty-msg">No medical records found.</li>';
        }
    })
    .catch(() => {
        document.getElementById('recordList').innerHTML = '<li class="empty-msg">Failed to load medical records.</li>';
    });
</script>
</body>
</html> 